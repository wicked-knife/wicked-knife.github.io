(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{178:function(s,t,a){"use strict";a.r(t);var e=a(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"添加-vue-支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加-vue-支持","aria-hidden":"true"}},[s._v("#")]),s._v(" 添加 Vue 支持")]),s._v(" "),a("p",[s._v("当基于 Vue 进行项目开发时，我们通常需要编写"),a("code",[s._v(".vue")]),s._v("形式的单文件组件。通过使用"),a("code",[s._v("vue-loader")]),s._v("我们可以在 webpack 中解析"),a("code",[s._v(".vue")]),s._v("文件。")]),s._v(" "),a("p",[s._v("安装"),a("code",[s._v("vue-loader")]),s._v(" 和 "),a("code",[s._v("vue-template-compiler")])]),s._v(" "),a("p",[s._v("根据 vue-loader 官方文档：")]),s._v(" "),a("p",[a("code",[s._v("你每次升级项目中的 vue 包时，也应该匹配升级 vue-template-compiler。")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("npm i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("D")]),s._v(" vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("loader vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compiler\n")])])]),a("p",[s._v("在"),a("code",[s._v("webpack.common.js")]),s._v("中作如下配置:")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" VueLoaderPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue-loader/lib/plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n    modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      rules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.vue$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          loader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue-loader'")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VueLoaderPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("即可在项目中直接把"),a("code",[s._v(".vue")]),s._v("文件当做模块进行引入。")]),s._v(" "),a("p",[s._v("这样配置在开发环境下是没有问题的，但在生产环境下进行打包的话会发现没有在"),a("code",[s._v(".vue")]),s._v("文件中书写的 css 没有打包出来。")]),s._v(" "),a("p",[s._v("通过查阅官方文档:")]),s._v(" "),a("div",{staticClass:"language-warning extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('如果你在开发一个库或多项目仓库 (monorepo)，请注意导入 CSS 是具有副作用的。\n请确保在 package.json 中移除 "sideEffects": false，\n否则 CSS 代码块会在生产环境构建时被 webpack 丢掉。\n')])])]),a("p",[s._v("但是我们有时候是需要引入一些带有"),a("code",[s._v("sideEffects")]),s._v("的模块的，比如 CSS 重置,babel-polyfill。所以我们应该进行这样的配置:")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"sideEffects"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@babel/polyfill"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.css"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.scss"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.vue"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[s._v("这样将所有的"),a("code",[s._v(".vue")]),s._v("文件标记为"),a("code",[s._v("sideEffects")]),s._v("模块，这样"),a("code",[s._v(".vue")]),s._v("文件中的 CSS 代码就可以正确打包了。")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v(".vue")]),s._v("文件中使用"),a("code",[s._v("import(...)")]),s._v("动态加载模块时，eslint 也许会警报，在"),a("code",[s._v(".eslintrc.js")]),s._v("中进行如下配置:")]),s._v(" "),a("div",{staticClass:"language-git extra-class"},[a("pre",{pre:!0,attrs:{class:"language-git"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'parserOptions'")]),s._v(": {\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[s._v("+++     'parser': 'babel-eslint',")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ecmaVersion'")]),s._v(": 2018,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sourceType'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'module'")]),s._v("\n    },\n")])])])])}],!1,null,null,null);t.default=n.exports}}]);